<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harper's Coffee Stand ‚òï</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            min-height: 100vh;
        }

        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 20px;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .mode-btn {
            padding: 15px 30px;
            font-size: 18px;
            border: 3px solid #ff6b6b;
            background: white;
            color: #ff6b6b;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .mode-btn:hover, .mode-btn.active {
            background: #ff6b6b;
            color: white;
            transform: scale(1.05);
        }

        .view {
            display: none;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .view.active {
            display: block;
        }

        /* Customer View Styles */
        .store-header {
            text-align: center;
            padding: 30px;
            background: white;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .store-header h1 {
            font-size: 2.5em;
            color: #5d4e37;
            margin-bottom: 10px;
        }

        .store-header .subtitle {
            color: #888;
            font-size: 1.2em;
        }

        .store-header .open-badge {
            display: inline-block;
            background: #4ecdc4;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            margin-top: 15px;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .menu-section {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .menu-section h2 {
            color: #5d4e37;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px dashed #ffecd2;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 15px;
            background: #fffaf5;
            border-radius: 15px;
            transition: transform 0.2s;
        }

        .menu-item:hover {
            transform: translateX(10px);
        }

        .menu-item .emoji {
            font-size: 3em;
            margin-right: 20px;
        }

        .menu-item .details {
            flex: 1;
        }

        .menu-item .name {
            font-size: 1.3em;
            font-weight: bold;
            color: #5d4e37;
        }

        .menu-item .description {
            color: #888;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .menu-item .price {
            font-size: 1.4em;
            font-weight: bold;
            color: #ff6b6b;
            margin-right: 15px;
        }

        .add-btn {
            background: #4ecdc4;
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .add-btn:hover {
            background: #45b7aa;
            transform: scale(1.1);
        }

        /* Cart Styles */
        .cart {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 20px;
        }

        .cart h2 {
            color: #5d4e37;
            margin-bottom: 20px;
        }

        .cart-empty {
            text-align: center;
            padding: 30px;
            color: #888;
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #fffaf5;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .cart-item .emoji {
            font-size: 1.5em;
            margin-right: 10px;
        }

        .cart-item .name {
            flex: 1;
            font-weight: bold;
            color: #5d4e37;
        }

        .cart-item .quantity {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .qty-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            margin-top: 15px;
            border-top: 3px dashed #ffecd2;
            font-size: 1.3em;
            font-weight: bold;
            color: #5d4e37;
        }

        .order-btn {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            transition: transform 0.2s;
        }

        .order-btn:hover {
            transform: scale(1.02);
        }

        .order-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* Special Instructions */
        .special-instructions {
            width: 100%;
            padding: 15px;
            border: 2px dashed #ffecd2;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 1em;
            resize: none;
        }

        /* Harper's View Styles */
        .harper-header {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            margin-bottom: 20px;
            color: white;
        }

        .harper-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .harper-header .order-count {
            font-size: 1.5em;
            opacity: 0.9;
        }

        .no-orders {
            text-align: center;
            padding: 60px;
            background: white;
            border-radius: 20px;
            color: #888;
        }

        .no-orders .emoji {
            font-size: 4em;
            margin-bottom: 20px;
        }

        .order-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .order-card.new {
            border: 4px solid #ff6b6b;
            animation: newOrder 1s ease infinite;
        }

        @keyframes newOrder {
            0%, 100% { box-shadow: 0 5px 20px rgba(255,107,107,0.3); }
            50% { box-shadow: 0 5px 40px rgba(255,107,107,0.6); }
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px dashed #ffecd2;
        }

        .order-number {
            font-size: 1.5em;
            font-weight: bold;
            color: #5d4e37;
        }

        .order-time {
            color: #888;
        }

        .order-status {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .order-status.new {
            background: #ff6b6b;
            color: white;
        }

        .order-status.preparing {
            background: #ffd93d;
            color: #5d4e37;
        }

        .order-status.ready {
            background: #4ecdc4;
            color: white;
        }

        .order-status.delivered {
            background: #6bcb77;
            color: white;
        }

        .order-items {
            margin-bottom: 20px;
        }

        .order-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #fffaf5;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .order-item .emoji {
            font-size: 2em;
            margin-right: 15px;
        }

        .order-item .details {
            flex: 1;
        }

        .order-item .qty {
            background: #ff6b6b;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .order-instructions {
            background: #fff3cd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .order-instructions strong {
            color: #856404;
        }

        .order-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .action-btn:hover {
            transform: scale(1.02);
        }

        .action-btn.preparing {
            background: #ffd93d;
            color: #5d4e37;
        }

        .action-btn.ready {
            background: #4ecdc4;
            color: white;
        }

        .action-btn.delivered {
            background: #6bcb77;
            color: white;
        }

        /* Order Confirmation Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            animation: popIn 0.3s ease;
        }

        @keyframes popIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-content .emoji {
            font-size: 5em;
            margin-bottom: 20px;
        }

        .modal-content h2 {
            color: #5d4e37;
            margin-bottom: 10px;
        }

        .modal-content p {
            color: #888;
            margin-bottom: 20px;
        }

        .modal-content .order-num {
            font-size: 2em;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 20px;
        }

        .modal-close {
            padding: 15px 40px;
            background: #4ecdc4;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
        }

        /* Sound Toggle */
        .sound-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 50%;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            cursor: pointer;
            font-size: 1.5em;
            z-index: 100;
        }

        /* Customer Name Input */
        .customer-name-section {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .customer-name-section label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #5d4e37;
        }

        .customer-name-section input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ffecd2;
            border-radius: 10px;
            font-size: 1.1em;
        }

        .customer-name-section input:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        /* Delivered Orders Section */
        .delivered-section {
            margin-top: 40px;
            opacity: 0.7;
        }

        .delivered-section h2 {
            color: #888;
            margin-bottom: 20px;
        }

        .delivered-section .order-card {
            opacity: 0.6;
        }

        /* Connection Status */
        .connection-status {
            text-align: center;
            padding: 10px;
            font-size: 0.9em;
        }

        .connection-status.connected {
            background: #d4edda;
            color: #155724;
        }

        .connection-status.disconnected {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <!-- Connection Status -->
    <div id="connection-status" class="connection-status connected">
        ‚úÖ Connected - Orders sync across devices!
    </div>

    <!-- Mode Selector -->
    <div class="mode-selector">
        <button class="mode-btn" onclick="showView('customer')">üõí Order Coffee</button>
        <button class="mode-btn active" onclick="showView('harper')">üë©‚Äçüç≥ Harper's Orders</button>
    </div>

    <!-- Customer View -->
    <div id="customer-view" class="view">
        <div class="store-header">
            <h1>‚òï Harper's Coffee Stand</h1>
            <p class="subtitle">The Best Pretend Coffee in Town!</p>
            <span class="open-badge">‚ú® OPEN NOW ‚ú®</span>
        </div>

        <div class="customer-name-section">
            <label>üëã Your Name:</label>
            <input type="text" id="customer-name" placeholder="Who's ordering?" value="Uncle/Auntie">
        </div>

        <div class="menu-section">
            <h2>‚òï Hot Drinks</h2>
            
            <div class="menu-item">
                <span class="emoji">‚òï</span>
                <div class="details">
                    <div class="name">Classic Coffee</div>
                    <div class="description">A warm cup of pretend coffee goodness</div>
                </div>
                <span class="price">$2</span>
                <button class="add-btn" onclick="addToCart('coffee', 'Classic Coffee', '‚òï', 2)">+</button>
            </div>

            <div class="menu-item">
                <span class="emoji">üç´</span>
                <div class="details">
                    <div class="name">Hot Chocolate</div>
                    <div class="description">Extra chocolatey with marshmallows!</div>
                </div>
                <span class="price">$3</span>
                <button class="add-btn" onclick="addToCart('hotchoc', 'Hot Chocolate', 'üç´', 3)">+</button>
            </div>

            <div class="menu-item">
                <span class="emoji">üçµ</span>
                <div class="details">
                    <div class="name">Warm Tea</div>
                    <div class="description">Cozy and comforting</div>
                </div>
                <span class="price">$2</span>
                <button class="add-btn" onclick="addToCart('tea', 'Warm Tea', 'üçµ', 2)">+</button>
            </div>
        </div>

        <div class="menu-section">
            <h2>üßä Cold Drinks</h2>
            
            <div class="menu-item">
                <span class="emoji">üßã</span>
                <div class="details">
                    <div class="name">Iced Coffee</div>
                    <div class="description">Cool and refreshing</div>
                </div>
                <span class="price">$3</span>
                <button class="add-btn" onclick="addToCart('icedcoffee', 'Iced Coffee', 'üßã', 3)">+</button>
            </div>

            <div class="menu-item">
                <span class="emoji">ü•§</span>
                <div class="details">
                    <div class="name">Lemonade</div>
                    <div class="description">Sweet and tangy</div>
                </div>
                <span class="price">$2</span>
                <button class="add-btn" onclick="addToCart('lemonade', 'Lemonade', 'ü•§', 2)">+</button>
            </div>

            <div class="menu-item">
                <span class="emoji">ü•õ</span>
                <div class="details">
                    <div class="name">Chocolate Milk</div>
                    <div class="description">Creamy chocolate deliciousness</div>
                </div>
                <span class="price">$2</span>
                <button class="add-btn" onclick="addToCart('chocomilk', 'Chocolate Milk', 'ü•õ', 2)">+</button>
            </div>
        </div>

        <div class="menu-section">
            <h2>üç™ Snacks</h2>
            
            <div class="menu-item">
                <span class="emoji">üç™</span>
                <div class="details">
                    <div class="name">Cookie</div>
                    <div class="description">Fresh baked chocolate chip</div>
                </div>
                <span class="price">$1</span>
                <button class="add-btn" onclick="addToCart('cookie', 'Cookie', 'üç™', 1)">+</button>
            </div>

            <div class="menu-item">
                <span class="emoji">üßÅ</span>
                <div class="details">
                    <div class="name">Cupcake</div>
                    <div class="description">With rainbow sprinkles!</div>
                </div>
                <span class="price">$3</span>
                <button class="add-btn" onclick="addToCart('cupcake', 'Cupcake', 'üßÅ', 3)">+</button>
            </div>

            <div class="menu-item">
                <span class="emoji">ü•ê</span>
                <div class="details">
                    <div class="name">Croissant</div>
                    <div class="description">Buttery and flaky</div>
                </div>
                <span class="price">$2</span>
                <button class="add-btn" onclick="addToCart('croissant', 'Croissant', 'ü•ê', 2)">+</button>
            </div>
        </div>

        <div class="cart">
            <h2>üõí Your Order</h2>
            <div id="cart-items">
                <div class="cart-empty">
                    <p>Your cart is empty!</p>
                    <p>Add some yummy items üëÜ</p>
                </div>
            </div>
            <div id="cart-total" style="display: none;">
                <div class="cart-total">
                    <span>Total:</span>
                    <span id="total-amount">$0</span>
                </div>
                <textarea class="special-instructions" id="special-instructions" placeholder="Special instructions for Harper... (extra sugar, no ice, etc.)"></textarea>
                <button class="order-btn" id="place-order-btn" onclick="placeOrder()">
                    üöÄ Place Order!
                </button>
            </div>
        </div>
    </div>

    <!-- Harper's View -->
    <div id="harper-view" class="view active">
        <div class="harper-header">
            <h1>üë©‚Äçüç≥ Harper's Kitchen</h1>
            <p class="order-count">You have <span id="active-order-count">0</span> orders to make!</p>
        </div>

        <div id="orders-container">
            <div class="no-orders">
                <div class="emoji">üò¥</div>
                <h2>No orders yet!</h2>
                <p>Waiting for customers...</p>
            </div>
        </div>

        <div id="delivered-orders" class="delivered-section" style="display: none;">
            <h2>‚úÖ Completed Orders</h2>
            <div id="delivered-container"></div>
        </div>
    </div>

    <!-- Order Confirmation Modal -->
    <div id="order-modal" class="modal">
        <div class="modal-content">
            <div class="emoji">üéâ</div>
            <h2>Order Placed!</h2>
            <p>Harper is getting your order ready!</p>
            <div class="order-num">Order #<span id="modal-order-num">1</span></div>
            <button class="modal-close" onclick="closeModal()">Got it!</button>
        </div>
    </div>

    <!-- Sound Toggle -->
    <div class="sound-toggle" id="sound-toggle" onclick="toggleSound()">üîî</div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBeSLHNmbvMqyyIZ_MBMcpnr5UqWD2QFLI",
            authDomain: "harpers-door-dash.firebaseapp.com",
            databaseURL: "https://harpers-door-dash-default-rtdb.firebaseio.com",
            projectId: "harpers-door-dash",
            storageBucket: "harpers-door-dash.firebasestorage.app",
            messagingSenderId: "382979755511",
            appId: "1:382979755511:web:0d6bee0355dad2ea50b2f2"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // State
        let cart = {};
        let orders = [];
        let soundEnabled = true;
        let lastOrderCount = 0;

        // Connection status
        const connectedRef = database.ref('.info/connected');
        connectedRef.on('value', (snap) => {
            const statusEl = document.getElementById('connection-status');
            if (snap.val() === true) {
                statusEl.className = 'connection-status connected';
                statusEl.textContent = '‚úÖ Connected - Orders sync across devices!';
            } else {
                statusEl.className = 'connection-status disconnected';
                statusEl.textContent = '‚ùå Disconnected - Trying to reconnect...';
            }
        });

        // Listen for orders in real-time
        const ordersRef = database.ref('orders');
        ordersRef.on('value', (snapshot) => {
            const data = snapshot.val();
            orders = data ? Object.values(data) : [];
            orders.sort((a, b) => b.id - a.id); // Sort by newest first
            
            // Check for new orders and play sound
            const newOrderCount = orders.filter(o => o.status === 'new').length;
            if (newOrderCount > lastOrderCount && document.getElementById('harper-view').classList.contains('active')) {
                playNotification();
            }
            lastOrderCount = newOrderCount;
            
            renderOrders();
        });

        // Get next order number
        async function getNextOrderNumber() {
            const counterRef = database.ref('orderCounter');
            const result = await counterRef.transaction((current) => {
                return (current || 0) + 1;
            });
            return result.snapshot.val();
        }

        // Switch between views
        function showView(view) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById(view + '-view').classList.add('active');
            document.querySelector(`.mode-btn[onclick="showView('${view}')"]`).classList.add('active');
        }

        // Add item to cart
        function addToCart(id, name, emoji, price) {
            if (cart[id]) {
                cart[id].quantity++;
            } else {
                cart[id] = { name, emoji, price, quantity: 1 };
            }
            renderCart();
            
            // Fun animation feedback
            const btn = event.target;
            btn.textContent = '‚úì';
            setTimeout(() => btn.textContent = '+', 300);
        }

        // Update cart quantity
        function updateQuantity(id, delta) {
            cart[id].quantity += delta;
            if (cart[id].quantity <= 0) {
                delete cart[id];
            }
            renderCart();
        }

        // Render cart
        function renderCart() {
            const cartItems = document.getElementById('cart-items');
            const cartTotal = document.getElementById('cart-total');
            const items = Object.entries(cart);
            
            if (items.length === 0) {
                cartItems.innerHTML = `
                    <div class="cart-empty">
                        <p>Your cart is empty!</p>
                        <p>Add some yummy items üëÜ</p>
                    </div>
                `;
                cartTotal.style.display = 'none';
                return;
            }
            
            let html = '';
            let total = 0;
            
            items.forEach(([id, item]) => {
                total += item.price * item.quantity;
                html += `
                    <div class="cart-item">
                        <span class="emoji">${item.emoji}</span>
                        <span class="name">${item.name}</span>
                        <div class="quantity">
                            <button class="qty-btn" onclick="updateQuantity('${id}', -1)">-</button>
                            <span>${item.quantity}</span>
                            <button class="qty-btn" onclick="updateQuantity('${id}', 1)">+</button>
                        </div>
                    </div>
                `;
            });
            
            cartItems.innerHTML = html;
            document.getElementById('total-amount').textContent = '$' + total;
            cartTotal.style.display = 'block';
        }

        // Place order
        async function placeOrder() {
            const customerName = document.getElementById('customer-name').value || 'Customer';
            const instructions = document.getElementById('special-instructions').value;
            
            const items = Object.entries(cart).map(([id, item]) => ({
                ...item,
                id
            }));
            
            let total = 0;
            items.forEach(item => total += item.price * item.quantity);
            
            const orderNumber = await getNextOrderNumber();
            
            const order = {
                id: orderNumber,
                customer: customerName,
                items: items,
                total: total,
                instructions: instructions,
                status: 'new',
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                timestamp: Date.now()
            };
            
            // Save to Firebase
            await database.ref('orders/' + orderNumber).set(order);
            
            // Show confirmation
            document.getElementById('modal-order-num').textContent = order.id;
            document.getElementById('order-modal').classList.add('active');
            
            // Clear cart
            cart = {};
            document.getElementById('special-instructions').value = '';
            renderCart();
        }

        // Close modal
        function closeModal() {
            document.getElementById('order-modal').classList.remove('active');
        }

        // Render orders for Harper
        function renderOrders() {
            const container = document.getElementById('orders-container');
            const deliveredContainer = document.getElementById('delivered-container');
            const deliveredSection = document.getElementById('delivered-orders');
            
            const activeOrders = orders.filter(o => o.status !== 'delivered');
            const deliveredOrders = orders.filter(o => o.status === 'delivered');
            
            document.getElementById('active-order-count').textContent = activeOrders.length;
            
            if (activeOrders.length === 0) {
                container.innerHTML = `
                    <div class="no-orders">
                        <div class="emoji">üò¥</div>
                        <h2>No orders yet!</h2>
                        <p>Waiting for customers...</p>
                    </div>
                `;
            } else {
                container.innerHTML = activeOrders.map(order => renderOrderCard(order)).join('');
            }
            
            if (deliveredOrders.length > 0) {
                deliveredSection.style.display = 'block';
                deliveredContainer.innerHTML = deliveredOrders.slice(0, 5).map(order => renderOrderCard(order)).join('');
            } else {
                deliveredSection.style.display = 'none';
            }
        }

        // Render single order card
        function renderOrderCard(order) {
            const statusClass = order.status;
            const statusText = {
                'new': 'üÜï NEW ORDER!',
                'preparing': 'üë©‚Äçüç≥ Making it...',
                'ready': '‚úÖ Ready!',
                'delivered': 'üéâ Delivered!'
            }[order.status];
            
            let actionsHtml = '';
            if (order.status === 'new') {
                actionsHtml = `
                    <button class="action-btn preparing" onclick="updateOrderStatus(${order.id}, 'preparing')">
                        üë©‚Äçüç≥ Start Making
                    </button>
                `;
            } else if (order.status === 'preparing') {
                actionsHtml = `
                    <button class="action-btn ready" onclick="updateOrderStatus(${order.id}, 'ready')">
                        ‚úÖ It's Ready!
                    </button>
                `;
            } else if (order.status === 'ready') {
                actionsHtml = `
                    <button class="action-btn delivered" onclick="updateOrderStatus(${order.id}, 'delivered')">
                        üöÄ Delivered!
                    </button>
                `;
            }
            
            return `
                <div class="order-card ${order.status === 'new' ? 'new' : ''}">
                    <div class="order-header">
                        <div>
                            <div class="order-number">Order #${order.id}</div>
                            <div class="order-time">üïê ${order.time} ‚Ä¢ üë§ ${order.customer}</div>
                        </div>
                        <span class="order-status ${statusClass}">${statusText}</span>
                    </div>
                    <div class="order-items">
                        ${order.items.map(item => `
                            <div class="order-item">
                                <span class="emoji">${item.emoji}</span>
                                <div class="details">
                                    <strong>${item.name}</strong>
                                </div>
                                <span class="qty">${item.quantity}</span>
                            </div>
                        `).join('')}
                    </div>
                    ${order.instructions ? `
                        <div class="order-instructions">
                            <strong>üìù Special Request:</strong> ${order.instructions}
                        </div>
                    ` : ''}
                    <div class="order-actions">
                        ${actionsHtml}
                    </div>
                </div>
            `;
        }

        // Update order status
        function updateOrderStatus(orderId, newStatus) {
            database.ref('orders/' + orderId + '/status').set(newStatus);
        }

        // Sound notification
        const notificationSound = new Audio('New Order Ready.mp3');
        
        function playNotification() {
            if (!soundEnabled) return;
            
            try {
                notificationSound.currentTime = 0;
                notificationSound.play();
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        // Toggle sound
        function toggleSound() {
            soundEnabled = !soundEnabled;
            document.getElementById('sound-toggle').textContent = soundEnabled ? 'üîî' : 'üîï';
        }

        // Initialize
        renderCart();
    </script>
</body>
</html>
